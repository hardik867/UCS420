
# ============================================================
# R Lab Manual - Probability and Statistics (Experiments 1 to 8)
# TIET, Patiala - UMA401
# Author: Generated by ChatGPT
# ============================================================

# ============================================================
# Experiment 1: Basics of R Programming
# ============================================================

# (1) Max and Min of a vector
c <- c(5, 10, 15, 20, 25, 30)
max_val <- max(c)
min_val <- min(c)
print(paste("Max:", max_val))
print(paste("Min:", min_val))

# (2) Factorial of a number
factorial_function <- function(n) {
  if (n < 0) {
    return("Error: Negative number!")
  } else {
    return(factorial(n))
  }
}
print(factorial_function(5))

# (3) Fibonacci sequence
fibonacci <- function(n) {
  fib <- numeric(n)
  fib[1] <- 0
  if(n > 1) fib[2] <- 1
  for (i in 3:n) {
    fib[i] <- fib[i - 1] + fib[i - 2]
  }
  return(fib)
}
print(fibonacci(10))

# (4) Simple Calculator
calculator <- function(a, b, op) {
  switch(op,
         "+" = a + b,
         "-" = a - b,
         "*" = a * b,
         "/" = ifelse(b != 0, a / b, "Divide by zero error"))
}
print(calculator(10, 2, "+"))

# (5) Plotting options
x <- c(10, 20, 30)
labels <- c("A", "B", "C")
pie(x, labels)
barplot(x, names.arg = labels)
plot(x, type = "o")

# ============================================================
# Experiment 2: Descriptive Statistics & Probability
# ============================================================

# (1a) Sample from chest
coins <- c(rep("gold", 20), rep("silver", 30), rep("bronze", 50))
sample(coins, 10)

# (1b) Surgical procedure outcomes
sample(c("Success", "Failure"), 10, replace = TRUE, prob = c(0.9, 0.1))

# (2) Birthday problem simulation
simulate_birthday <- function(n, trials = 1000) {
  count <- 0
  for (i in 1:trials) {
    bdays <- sample(1:365, n, replace = TRUE)
    if (length(unique(bdays)) < n) count <- count + 1
  }
  return(count / trials)
}
simulate_birthday(23)

# (3) Conditional probability
P_C <- 0.4
P_R <- 0.2
P_C_R <- 0.85
P_R_C <- (P_C_R * P_R) / P_C
P_R_C

# (4) Iris dataset statistics
data(iris)
head(iris)
str(iris)
range(iris$Sepal.Length)
mean(iris$Sepal.Length)
median(iris$Sepal.Length)
quantile(iris$Sepal.Length, probs = c(0.25, 0.75))
IQR(iris$Sepal.Length)
sd(iris$Sepal.Length)
var(iris$Sepal.Length)
summary(iris)

# (5) Mode function
get_mode <- function(v) {
  uniqv <- unique(v)
  uniqv[which.max(tabulate(match(v, uniqv)))]
}
get_mode(iris$Sepal.Length)

# Due to size limits, we'll continue this script in the next chunk.
